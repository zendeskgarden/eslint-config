import{b as oe,a as te,s as se,c as ie,F as ue,d as ae}from"./DM2Iv_Px.js";import{_ as re,a as le,g as W}from"./DcKMyLUs.js";import{_ as pe}from"./BPrPIMhO.js";import{g as Q,m as X,j as de,r as V,k as ne,n as fe,l as z,L as ce,c as s,o as n,A as F,a as t,q as m,t as f,v as D,b as y,F as v,s as R,M as ge,y as o,w as Y,E as L,d as U,N as ve,O as P,P as me,H as be,Q as r,R as Z,z as j,S as he,T as ye,B as h,I as ke,U as xe,V as _e,W as we,X as M,Y as Ce,J as $e,Z as G,$ as H,a0 as ee,a1 as J}from"./CmtEZGNH.js";const Oe=["open"],je={block:""},Me={class:"absolute right-[calc(100%+10px)] top-1.5","text-right":"","font-mono":"",op35:"","lt-lg:hidden":""},Fe={flex:"~ gap-2 items-center","cursor-pointer":"","select-none":"","bg-hover":"",px2:"",py2:"","text-sm":"","font-mono":""},Se={flex:"","flex-auto":"","flex-col":"","flex-wrap":"","gap-3":"","md:flex-row":"","md:justify-end":""},Ie={key:1},Re={flex:"~ gap-2 items-start"},Ee={"pointer-events-none":"",absolute:"","right-2":"","top-2":"","text-right":"","text-5em":"","font-mono":"",op5:""},Te={key:0,flex:"~ col gap-4","of-auto":"",px4:"",py3:""},De={key:0,flex:"~ gap-2 items-start"},Ne={flex:"~ col gap-2"},Pe={flex:"~ gap-2 items-center wrap"},Ae={key:1,flex:"~ gap-2 items-center"},Be={key:2,flex:"~ gap-2 items-start"},Ge={flex:"~ col gap-2"},Ve={flex:"~ gap-2 items-center wrap"},ze=["onClick"],Le={key:3,flex:"~ gap-2 items-start"},Ue={flex:"~ col gap-2"},qe={key:0},Ke={key:1},He={flex:"~ gap-2 items-center wrap"},Je={key:4},Qe={flex:"~ gap-2 items-center"},We=["onClick"],Xe={key:5,flex:"~ gap-2"},Ye={flex:"~ col gap-2","w-full":""},Ze={"of-auto":"",p2:"",px3:"",op50:""},et=Q({__name:"ConfigItem",props:X({config:{},index:{},filters:{},active:{type:Boolean},matchedGlobs:{}},{open:{default:!0},openModifiers:{}}),emits:X(["badgeClick"],["update:open"]),setup(q,{emit:k}){const K=q,A=k,$=new Set(["name"]),O=new Set(["index"]),E=de(q,"open"),x=V(E.value);if(!x.value){const l=ne(()=>{E.value&&(x.value=!0,l())})}const _=fe();function w(l){be.plugin=l,_.push("/rules")}const S=z(()=>{const l=["files","plugins","ignores","rules","name","index"];return Object.fromEntries(Object.entries(K.config).filter(([a])=>!l.includes(a)))});return(l,a)=>{const b=re,I=pe,N=le,B=oe,p=te,e=ie,g=ce("close-popper");return n(),s("details",{class:F(["flat-config-item",l.active?"border-yellow:70":"border-base"]),open:E.value,border:"~ rounded-lg",relative:"",onToggle:a[1]||(a[1]=i=>E.value=i.target.open)},[t("summary",je,[t("div",Me," #"+f(l.index+1),1),t("div",Fe,[a[2]||(a[2]=t("div",{class:"[details[open]_&]:rotate-90","i-ph-caret-right":"","flex-none":"",op50:"",transition:""},null,-1)),t("div",Se,[t("span",{class:F(l.config.name?"":"op50 italic"),"flex-1":""},[l.config.name?(n(),D(b,{key:0,name:l.config.name},null,8,["name"])):(n(),s("span",Ie,"anonymous #"+f(l.index+1),1))],2),t("div",Re,[y(I,{icon:"i-ph-file-magnifying-glass-duotone",number:l.config.files?.length||0,color:"text-yellow5",title:"Files"},null,8,["number"]),y(I,{icon:"i-ph-eye-closed-duotone",number:l.config.ignores?.length||0,color:"text-purple5 dark:text-purple4",title:"Ignores"},null,8,["number"]),y(I,{icon:"i-ph-sliders-duotone",number:Object.keys(S.value).length,color:"text-green5",title:"Options"},null,8,["number"]),y(I,{icon:"i-ph-plug-duotone",number:Object.keys(l.config.plugins||{}).length,color:"text-teal5",title:"Plugins"},null,8,["number"]),y(I,{icon:"i-ph-list-dashes-duotone",number:Object.keys(l.config.rules||{}).length,color:"text-blue5 dark:text-blue4",title:"Rules","mr-2":""},null,8,["number"])])])])]),t("div",Ee," #"+f(l.index+1),1),x.value?(n(),s("div",Te,[l.config.files?(n(),s("div",De,[a[4]||(a[4]=t("div",{"i-ph-file-magnifying-glass-duotone":"",my1:"","flex-none":""},null,-1)),t("div",Ne,[a[3]||(a[3]=t("div",null,"Applies to files matching",-1)),t("div",Pe,[(n(!0),s(v,null,R(l.config.files?.flat(),(i,d)=>(n(),D(N,{key:d,glob:i,popup:"files",active:l.matchedGlobs?.includes(i)},null,8,["glob","active"]))),128))])])])):l.config.rules||Object.keys(S.value).length?(n(),s("div",Ae,a[5]||(a[5]=[t("div",{"i-ph-files-duotone":"","flex-none":""},null,-1),t("div",null,"Generally applies to all files",-1)]))):m("",!0),l.config.plugins?(n(),s("div",Be,[a[6]||(a[6]=t("div",{"i-ph-plug-duotone":"",my1:"","flex-none":""},null,-1)),t("div",Ge,[t("div",null,"Plugins ("+f(Object.keys(l.config.plugins).length)+")",1),t("div",Ve,[(n(!0),s(v,null,R(Object.keys(l.config.plugins),(i,d)=>(n(),s("button",{key:d,border:"~ base rounded-full",px3:"",style:ge({color:("getPluginColor"in l?l.getPluginColor:o(W))(i),backgroundColor:("getPluginColor"in l?l.getPluginColor:o(W))(i,.1)}),"font-mono":"",onClick:c=>w(i)},f(i),13,ze))),128))])])])):m("",!0),l.config.ignores?(n(),s("div",Le,[a[7]||(a[7]=t("div",{"i-ph-eye-closed-duotone":"",my1:"","flex-none":""},null,-1)),t("div",Ue,[Object.keys(l.config).some(i=>i!=="ignores"&&!o(O).has(i)&&!o($).has(i))===!1?(n(),s("div",qe," Ignore files globally ")):(n(),s("div",Ke," Ignore ")),t("div",He,[(n(!0),s(v,null,R(l.config.ignores,(i,d)=>(n(),D(N,{key:d,glob:i,active:l.matchedGlobs?.includes(i)},null,8,["glob","active"]))),128))])])])):m("",!0),l.config.rules&&Object.keys(l.config.rules).length?(n(),s("div",Je,[t("div",Qe,[a[8]||(a[8]=t("div",{"i-ph-list-dashes-duotone":"",my1:"","flex-none":""},null,-1)),t("div",null,"Rules ("+f(Object.keys(l.config.rules).length)+")",1)]),y(p,{py2:"",class:F(o(me)?"pl6":""),rules:l.config.rules,filter:i=>!l.filters?.rule||l.filters.rule===i,"get-bind":i=>({class:o(P)(l.config.rules?.[i])==="off"?"op50":""})},{popup:Y(({ruleName:i,value:d})=>[y(B,{border:"t base","is-local":!0,state:{name:i,level:o(P)(d),configIndex:l.index,options:o(ve)(d)}},null,8,["state"])]),"popup-actions":Y(({ruleName:i})=>[L((n(),s("button",{"btn-action-sm":"",onClick:d=>A("badgeClick",i)},a[9]||(a[9]=[t("div",{"i-ph-funnel-duotone":""},null,-1),U(" Filter by this rule ",-1)]),8,We)),[[g]])]),_:1},8,["class","rules","filter","get-bind"]),t("div",null,[l.filters?.rule?(n(),s("button",{key:0,ml8:"",op50:"",onClick:a[0]||(a[0]=i=>A("badgeClick",""))}," ..."+f(Object.keys(l.config.rules).filter(i=>i!==l.filters?.rule).length)+" others rules are hidden ",1)):m("",!0)])])):m("",!0),Object.keys(S.value).length?(n(),s("div",Xe,[a[11]||(a[11]=t("div",{"i-ph-sliders-duotone":"",my1:"","flex-none":""},null,-1)),t("div",Ye,[a[10]||(a[10]=t("div",null," Additional configurations ",-1)),(n(!0),s(v,null,R(S.value,(i,d)=>(n(),s("div",{key:d,border:"~ base rounded-lg"},[t("div",Ze,f(d),1),y(e,{lang:"ts",code:o(se)(i),"max-h-100":"","max-w-full":"","w-full":"","of-scroll":"",rounded:"","bg-code":"",p2:"","text-sm":""},null,8,["code"])]))),128))])])):m("",!0)])):m("",!0)],42,Oe)}}}),tt=Object.assign(et,{__name:"ConfigItem"}),lt={flex:"~ col gap-3",py4:""},nt={relative:"",flex:""},ot={pos:"absolute left-8 right-8 top-1/1",border:"~ base rounded",flex:"~ col","z-1":"","mt--1":"","max-h-80":"","of-auto":"","bg-glass":"",py1:"",shadow:""},st=["onClick"],it={key:0,flex:"~ gap-2 items-center wrap",mb2:""},ut={key:0},at={key:0,op50:""},rt={key:1},pt={flex:"~ gap-2 items-center",border:"~ blue/20 rounded-full","bg-blue:10":"",px3:"",py1:""},dt={flex:"~ gap-2 items-center wrap"},ft={key:0,border:"~ base rounded",flex:""},ct={key:1,flex:"~ gap-2 items-center",ml2:"","select-none":""},gt=["checked"],vt={flex:"~ gap-2 items-center wrap"},mt={class:"flat-config-item",border:"~ base rounded-lg",relative:""},bt={block:""},ht={flex:"~ gap-2 items-start","cursor-pointer":"","select-none":"","bg-hover":"",px2:"",py2:"","text-sm":"","font-mono":"",op75:""},yt={class:"flat-config-item",border:"~ base rounded-lg",open:"",relative:""},kt={block:""},xt={flex:"~ gap-2 items-start","cursor-pointer":"","select-none":"","bg-hover":"",px2:"",py2:"","text-sm":"","font-mono":"",op75:""},_t={px4:"",pt4:""},wt={px4:"",pt4:""},Mt=Q({__name:"configs",setup(q){const k=V(r.filepath);function K(){M.value=M.value.map(()=>!0)}function A(){M.value=M.value.map(()=>!1)}const $=Z([]),O=Z(null);ne(()=>{let p=j.value.configs;r.filepath?(O.value=he(r.filepath,j.value.configs,j.value.meta.basePath),O.value.configs.length?p=Array.from(new Set([...O.value.configs,...j.value.configsGeneral.filter(e=>!ye(e)).map(e=>e.index)])).sort().map(e=>j.value.configs[e]):p=[]):O.value=null,r.rule&&(p=p.filter(e=>r.rule in(e.rules||{}))),$.value=p});const E=z(()=>new ue(j.value.filesResolved?.list||[],{threshold:.3,includeMatches:!0})),x=z(()=>E.value.search(r.filepath||"")),_=V(0),w=V(!1);function S(p=_.value){w.value&&(k.value=r.filepath=x.value[p]?.item||r.filepath,w.value=!1)}function l(){setTimeout(()=>{w.value=!1},100)}function a(p){w.value&&(_.value+=p,_.value<0&&(_.value+=x.value.length),_.value>=x.value.length&&(_.value-=x.value.length))}const b=z(()=>{if(!r.filepath||h.value.viewFileMatchType!=="merged")return{all:{},common:{},specific:{},specificDisabled:{},specificEnabled:{}};const p={},e={},g={};$.value.forEach(c=>{c.rules&&(Object.assign(p,c.rules),c.files?Object.assign(g,c.rules):Object.assign(e,c.rules))});const i=Object.fromEntries(Object.entries(g).filter(([c,u])=>P(u)==="off")),d=Object.fromEntries(Object.entries(g).filter(([c,u])=>P(u)!=="off"));for(const c in p)P(p[c])==="off"&&delete p[c];return{all:p,common:e,specific:g,specificDisabled:i,specificEnabled:d}}),I=Q({props:{matches:Array},setup(p){return()=>p.matches?.map(e=>{let g=0;const i=e.value||"",d=[];for(const[c,u]of e.indices)g<c&&d.push(J("span",{class:"op50"},i.slice(g,c))),d.push(J("span",{class:"text-purple font-bold"},i.slice(c,u+1))),g=u+1;return g<i.length&&d.push(J("span",{class:"op50"},i.slice(g))),d})}});ke(()=>k.value,()=>{r.filepath=k.value,_.value=0},{debounce:200}),xe(()=>r.filepath,()=>{r.filepath!==k.value&&(k.value=r.filepath)},{flush:"sync"});const N=new Map,B=_e();return we(async()=>{if(B.query.index!=null){const p=Number(B.query.index)-1;M.value=M.value.map((e,g)=>g===p),await Ce(),N.get(p)?.scrollIntoView({behavior:"smooth",block:"start"})}}),(p,e)=>{const g=ae,i=le,d=te,c=tt;return n(),s("div",null,[t("div",lt,[t("div",nt,[L(t("input",{"onUpdate:modelValue":e[0]||(e[0]=u=>k.value=u),placeholder:"Test matching with filepath...",border:"~ base rounded-full",class:F(k.value?"font-mono":""),"w-full":"","bg-transparent":"",px3:"",py2:"",pl10:"","outline-none":"",onFocus:e[1]||(e[1]=u=>w.value=!0),onClick:e[2]||(e[2]=u=>w.value=!0),onBlur:l,onKeydown:[e[3]||(e[3]=G(u=>w.value=!1,["esc"])),e[4]||(e[4]=G(H(u=>a(1),["prevent"]),["down"])),e[5]||(e[5]=G(H(u=>a(-1),["prevent"]),["up"])),e[6]||(e[6]=G(H(u=>S(),["prevent"]),["enter"]))]},null,34),[[$e,k.value]]),e[13]||(e[13]=t("div",{absolute:"","bottom-0":"","left-0":"","top-0":"",flex:"~ items-center justify-center",p4:"",op50:""},[t("div",{"i-ph-magnifying-glass-duotone":""})],-1)),L(t("div",ot,[(n(!0),s(v,null,R(x.value,(u,C)=>(n(),s("button",{key:u.item,class:F(C===_.value?"bg-active":""),px3:"","py0.5":"","text-left":"","font-mono":"","hover:bg-active":"",onClick:T=>S(C)},[u.matches?(n(),D(o(I),{key:0,matches:u.matches},null,8,["matches"])):(n(),s(v,{key:1},[U(f(u.item),1)],64))],10,st))),128))],512),[[ee,w.value&&x.value.length]])]),o(r).filepath||o(r).rule?(n(),s("div",it,[o(r).filepath?(n(),s("div",ut,[t("div",{flex:"~ gap-2 items-center wrap",border:"~ purple/20 rounded-full","bg-purple:10":"",px3:"",py1:"",class:F({"saturate-0":!$.value.length})},[e[19]||(e[19]=t("div",{"i-ph-file-dotted-duotone":"","text-purple":""},null,-1)),e[20]||(e[20]=t("span",{op50:""},"Filepath",-1)),t("code",null,f(o(r).filepath),1),$.value.length?o(h).viewFileMatchType==="configs"?(n(),s(v,{key:1},[e[14]||(e[14]=t("span",{op50:""},"matched with",-1)),t("span",null,f($.value.length)+" / "+f(o(j).configs.length),1),e[15]||(e[15]=t("span",{op50:""},"config items",-1))],64)):(n(),s(v,{key:2},[e[16]||(e[16]=t("span",{op50:""},"matched with total ",-1)),t("span",null,f(Object.keys(b.value.all).length),1),e[17]||(e[17]=t("span",{op50:""},"rules, ",-1)),t("span",null,f(Object.keys(b.value.specific).length),1),e[18]||(e[18]=t("span",{op50:""},"of them are specific to the file",-1))],64)):(n(),s("span",at,"is not included or has been ignored")),t("button",{"i-ph-x":"","text-sm":"",op25:"","hover:op100":"",onClick:e[7]||(e[7]=u=>{o(r).filepath="",k.value=""})})],2)])):m("",!0),o(r).rule?(n(),s("div",rt,[t("div",pt,[e[21]||(e[21]=t("div",{"i-ph-funnel-duotone":""},null,-1)),e[22]||(e[22]=t("span",{op50:""},"Filtered by",-1)),y(g,{name:o(r).rule},null,8,["name"]),e[23]||(e[23]=t("span",{op50:""},"rule",-1)),t("button",{"i-ph-x":"","text-sm":"",op25:"","hover:op100":"",onClick:e[8]||(e[8]=u=>o(r).rule="")})])])):m("",!0)])):m("",!0),t("div",dt,[o(r).filepath?(n(),s("div",ft,[t("button",{class:F(o(h).viewFileMatchType==="configs"?"btn-action-active":"op50"),"btn-action":"","border-none":"",onClick:e[9]||(e[9]=u=>o(h).viewFileMatchType=o(h).viewFileMatchType==="configs"?"merged":"configs")},e[24]||(e[24]=[t("div",{"i-ph-stack-duotone":""},null,-1),t("span",null,"Matched Config Items",-1)]),2),e[26]||(e[26]=t("div",{border:"l base"},null,-1)),t("button",{class:F(o(h).viewFileMatchType!=="configs"?"btn-action-active":"op50"),"btn-action":"","border-none":"",onClick:e[10]||(e[10]=u=>o(h).viewFileMatchType=o(h).viewFileMatchType==="configs"?"merged":"configs")},e[25]||(e[25]=[t("div",{"i-ph-film-script-duotone":""},null,-1),t("span",null,"Merged Rules",-1)]),2)])):m("",!0),o(r).filepath&&o(h).viewFileMatchType==="configs"?(n(),s("label",ct,[t("input",{checked:o(h).showSpecificOnly,type:"checkbox",onChange:e[11]||(e[11]=u=>o(h).showSpecificOnly=!!u.target.checked)},null,40,gt),e[27]||(e[27]=t("span",{op50:""},"Show Specific Rules Only",-1))])):m("",!0),e[28]||(e[28]=t("div",{"flex-auto":""},null,-1)),t("button",{"btn-action":"",px3:"",onClick:K}," Expand All "),t("button",{"btn-action":"",px3:"",onClick:A}," Collapse All ")]),$.value.length?(n(),s(v,{key:2},[o(r).filepath&&o(h).viewFileMatchType==="merged"?(n(),s(v,{key:0},[t("details",mt,[t("summary",bt,[t("div",ht,[e[31]||(e[31]=t("div",{"i-ph-caret-right":"",class:"[details[open]_&]:rotate-90",transition:""},null,-1)),U(" Merged Rules: Common to every file ("+f(Object.keys(b.value.common).length)+" rules) ",1)])]),y(d,{m4:"",rules:b.value.common},null,8,["rules"])]),t("details",yt,[t("summary",kt,[t("div",xt,[e[32]||(e[32]=t("div",{"i-ph-caret-right":"",class:"[details[open]_&]:rotate-90",transition:""},null,-1)),U(" Merged Rules: Specific to matched file ("+f(Object.keys(b.value.specific).length)+" rules) ",1)])]),Object.keys(b.value.specificDisabled).length?(n(),s(v,{key:0},[t("div",_t," Disables ("+f(Object.keys(b.value.specificDisabled).length)+") ",1),y(d,{m4:"","get-bind":u=>({class:"op50"}),rules:b.value.specificDisabled},null,8,["rules"])],64)):m("",!0),Object.keys(b.value.specificEnabled).length?(n(),s(v,{key:1},[t("div",wt," Enables ("+f(Object.keys(b.value.specificEnabled).length)+") ",1),y(d,{m4:"",rules:b.value.specificEnabled},null,8,["rules"])],64)):m("",!0)])],64)):(n(!0),s(v,{key:1},R(o(j).configs,(u,C)=>L((n(),D(c,{key:C,ref_for:!0,ref:T=>{o(N).set(C,T?.$el)},open:o(M)[C],"onUpdate:open":T=>o(M)[C]=T,payload:o(j),config:u,index:C,filters:o(r),active:!!(o(r).filepath&&u.files),"matched-globs":O.value?.globs,onBadgeClick:e[12]||(e[12]=T=>o(r).rule=T)},null,8,["open","onUpdate:open","payload","config","index","filters","active","matched-globs"])),[[ee,$.value.includes(u)&&(!o(r).filepath||!o(h).showSpecificOnly||u.files)]])),128))],64)):(n(),s(v,{key:1},[e[30]||(e[30]=t("div",{mt5:"",italic:"",op50:""}," No matched config items. ",-1)),O.value?.globs.length?(n(),s(v,{key:0},[e[29]||(e[29]=t("div",null,"Ignored by globs:",-1)),t("div",vt,[(n(!0),s(v,null,R(O.value.globs,(u,C)=>(n(),D(i,{key:C,glob:u,popup:"configs"},null,8,["glob"]))),128))])],64)):m("",!0)],64))])])}}});export{Mt as default};
